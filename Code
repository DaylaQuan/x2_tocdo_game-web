
(function() {
    console.clear();
    // --- C·∫§U H√åNH ---
    var SPEED_NORMAL = 0.5;   // T·ªëc ƒë·ªô 1x (B√¨nh th∆∞·ªùng)
    var SPEED_SLOW = 0.15;    // T·ªëc ƒë·ªô 0.15x (Ch·∫≠m, ƒë·ªÅ ngh·ªã d√πng ƒë·ªÉ n√©)
    window.currentSpeed = SPEED_NORMAL;
    var originalNow = window.performance.now;
    var lastRealTime = originalNow.call(window.performance);
    var virtualTime = lastRealTime;
    window.performance.now = function() {
        var realNow = originalNow.call(window.performance);
        var dt = realNow - lastRealTime; 
        virtualTime += dt * window.currentSpeed;
        lastRealTime = realNow;
        return virtualTime;
    };
    var originalDateNow = Date.now;
    var startDateReal = originalDateNow();
    var startDateVirtual = startDateReal;
    Date.now = function() {
        return startDateVirtual + (window.performance.now() - virtualTime); 
    }
    var originalRaf = window.requestAnimationFrame;
    window.requestAnimationFrame = function(callback) {
        return originalRaf(function(timestamp) {
            callback(window.performance.now()); 
        });
    };
    document.addEventListener('keydown', function(e) {
        if (e.key === "Shift" || e.code === "ShiftLeft") {
            if (window.currentSpeed !== SPEED_SLOW) {
                window.currentSpeed = SPEED_SLOW;
                console.log("üê¢ Slow Motion: ON (Nh·∫£ Shift ƒë·ªÉ r·∫Ω nhanh)");
            }
        }
    });
    document.addEventListener('keyup', function(e) {
        if (e.key === "Shift" || e.code === "ShiftLeft") {
            window.currentSpeed = SPEED_NORMAL;
            console.log("üêá Normal Speed: ON");
        }
    });
    alert(" \n\nChi·∫øn l∆∞·ª£c ch∆°i:\n1. TH·∫¢ SHIFT ƒë·ªÉ ch·∫°y v√† r·∫Ω nhanh.\n2. GI·ªÆ SHIFT ƒë·ªÉ l√†m ch·∫≠m game v√† n√© ch∆∞·ªõng ng·∫°i v·∫≠t.");
})();
